<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <style>
      body {
        width: 600px;
        height: 600px;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <script type="text/javascript">
      // Define some constants.
      const canvasHeight = 1200;
      const canvasWidth = 1200;

      /**
       * Draws a rounded rectangle using the current state of the canvas.
       * If you omit the last three params, it will draw a rectangle
       * outline with a 5 pixel border radius
       * @param {CanvasRenderingContext2D} ctx
       * @param {Number} x The top left x coordinate
       * @param {Number} y The top left y coordinate
       * @param {Number} width The width of the rectangle
       * @param {Number} height The height of the rectangle
       * @param {Number} radius The corner radius. Defaults to 5;
       * @param {Boolean} fill Whether to fill the rectangle. Defaults to false.
       * @param {Boolean} stroke Whether to stroke the rectangle. Defaults to true.
       */
      function roundRect(ctx, x, y, width, height, radius, fill, stroke) {
        if (typeof stroke == "undefined") {
          stroke = true;
        }
        if (typeof radius === "undefined") {
          radius = 5;
        }
        ctx.beginPath();
        ctx.moveTo(x + radius, y);
        ctx.lineTo(x + width - radius, y);
        ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
        ctx.lineTo(x + width, y + height - radius);
        ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
        ctx.lineTo(x + radius, y + height);
        ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
        ctx.lineTo(x, y + radius);
        ctx.quadraticCurveTo(x, y, x + radius, y);
        ctx.closePath();
        if (stroke) {
          ctx.stroke();
        }
        if (fill) {
          ctx.fill();
        }
      }
      
      //ctx.font = "20px Georgia";
      //ctx.textAlign = "center";
      //ctx.textBaseline = "middle";
      //ctx.fillStyle = "#000000";
      //var rectHeight = 50;
      //var rectWidth = 100;
      //var rectX = 10;
      //var rectY = 10;
      //ctx.fillText("Attack!", rectX + rectWidth / 2, rectY + rectHeight / 2);

      function drawText(ctx) {
        const hashtag = "${displayHashtag}";
        const id = "${id}";
        //const creator = "${creator}";
        //const publisher = "${publisher}";
        const createDate = "${date}";
        //const hashtag = "#0x9D5Bc338891";
        //const id = "001";
        //const creator = "0x9D5Bc338891325896b8fF86EE371DcefEBD106e7";
        //const publisher = "0x9D5Bc338891325896b8fF86EE371DcefEBD106e7";
        //const createDate = "Mar 2, 2021";

        let fontsize = 300;
        ctx.fillStyle = "#FFFFFF";
        // lower the font size until the text fits the canvas
        do {
          fontsize--;
          ctx.font = "bold " + fontsize + "px Roboto";
        } while (ctx.measureText(hashtag).width > canvasWidth - 400);
        // draw the text.
        ctx.textBaseline = "middle";
        ctx.textAlign = "center";
        ctx.fillText(hashtag, canvasHeight / 2, canvasHeight / 2);

        // Now let's draw the green rectangle background.
        // We use the width of the letter M as our padding
        // criteria.
        let bgRectangleWidth =
          ctx.measureText(hashtag).width + ctx.measureText("M").width;
        let bgRectangleHeight = ctx.measureText("M").width * 2;

        ctx.fillStyle = "#24AE60";
        roundRect(
          ctx,
          canvasWidth / 2 - bgRectangleWidth / 2, // x pos
          canvasHeight / 2 - (bgRectangleHeight / 2 + bgRectangleHeight * 0.05), // y pos
          bgRectangleWidth, // width
          bgRectangleHeight, // height
          15,
          true,
          false
        );

        // Draw the text again.
        ctx.fillStyle = "#FFF";
        ctx.fillText(hashtag, canvasHeight / 2, canvasHeight / 2);

        ctx.fillStyle = "#FFF";
        ctx.font = "bold 20px Roboto";
        ctx.textAlign = "left";
        ctx.textBaseline = "top";
        ctx.fillText("HASHTAG TOKEN " + id, 20, canvasHeight - 40);
        ctx.textAlign = "right";
        ctx.fillText(
          "MINTED " + createDate.toUpperCase(),
          canvasWidth - 20,
          canvasHeight - 40
        );
      }

      function drawToken() {
        let canvas = /** @type {HTMLCanvasElement} */ document.getElementById(
          "canvas"
        );
        let ctx = canvas.getContext("2d");

        canvas.width = canvasWidth; //horizontal resolution (?) - increase for better looking text
        canvas.height = canvasHeight; //vertical resolution (?) - increase for better looking text
        canvas.style.width = 600; //actual width of canvas
        canvas.style.height = 600; //actual height of canvas
        ctx.fillStyle = "#4a4a4a";
        roundRect(ctx, 0, 0, 1200, 1200, 20, true, false);

        drawText(ctx);
      }

      // async font loading
      // https://github.com/typekit/webfontloader
      WebFont.load({
        google: {
          families: ["Roboto", "Roboto:bold"],
        },
        active: function () {
          drawToken();
        },
      });
    </script>
  </body>
</html>
